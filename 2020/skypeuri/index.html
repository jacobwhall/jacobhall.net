<!DOCTYPE html>
<html lang="en">
<head>
		<title>Testing Skype URIs on MacOS</title>
		<meta charset="utf-8"/>
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<meta name="theme-color" content="#FFFFFF"/>
		<!-- <link rel="stylesheet" type="text/css" href="/articlestyle.css"> -->
		<style>
		/* sitewide stuff like fonts and title sizes */
		body {
			text-align: center;
			font-family: 'Work Sans', sans-serif;
			font-size: 100%;
			font-size: max(100%, .4cm);
		}

		@media (max-aspect-ratio: 1/1) {
			body {
				font-size: 4vw;
				font-size: min(4vw, .4cm);
			}
		}
		body, h1, h2, h3, h4, h5, h6 {
			font-size-adjust: 0.5;
		}

		ul {
			list-style-position: inside;
			padding-left: 0.5em;
		}
		/* h-entry rules */
		.p-note {
			display: none;
		}
		
		/* code highlighting rules */
		.code {
			overflow-x:auto;
			/* white-space: pre-wrap; */
			font-family: monospace;
		}
		pre.code {
			border: 1em solid #2c2e34;
			border-radius: 1em;	
			color: #c5cdd9;
			background-color: #2c2e34;
		}
		.code a {
			color: inherit;
		}
		.code .Comment {
			color: #828a98;
			font-style: italic;
		}
		.code .Constant {
			color: #a0c980;
		}
		/* not used? might remove. i don't make errors ;) */
		.code .Error {
			color: #ffffff;
			background-color: #ff6060;
			padding-bottom: 1px;
		}
		.code .Identifier {
			color: #6cb6eb;
		}
		.code .PreProc {
			color: #ec7279;
		}
		.code .Special {
			color: #c5cdd9;
		}
		.code .Statement {
			color: #d38aea;
		}	
		.code .vimCommand {
			color: #d38aea;
		}	
		.code .texStatement {
			color: #6cb6eb;
		}
		.code .texSpecial {
			color: #deb974;
		}
		#license #indiewebring {
			display: inline-block;
			width: 50em;
			min-width: 50%;
			max-width: 100%;
		}
		u:-webkit-scrollbar {
			display: none;
		}

		.warning {
			color:red;
		}
		#backprofilepic {
			border-radius: 50%;
			height: 4em;
		}
		#sidebar {
			padding: 1em;
			text-align: left;
			line-height: 2em;
		}
		.date {
			color: gray;
			font-style: italic;
		}
		.nostyle {
			color: black;
			text-decoration: none;
		}
		table {
			margin: 0 auto;
			border-collapse: collapse;
			margin-bottom: 1em;
		}
		table, th, td {
			border: 1px solid black;
		}
		th, td {
			padding: .5em;
		}
		#scifairimg {
			object-fit: scale-down;
			width: 100%;
			max-width: 40em;
		}
		.graph {
			object-fit: contain;
			width: 100%;
			max-width: 30em;
		}
		.graphboxwrapper {
			text-align: center;
		}
		.graphbox {
			display:inline-block;
			padding: .75em;
			border: 1px solid lightgrey;
		}
		.slider {
			object-fit: contain;
			width: 100%;
			max-width: 34.5em;
		}
		#backprofilepic {
			border-radius: 50%;
			height: 4em;
		}
		#sidebar {
			padding: 1em;
			text-align: left;
			line-height: 2em;
		}
		.nostyle {
			color: black;
			text-decoration: none;
		}

		/* entire container, keeps perspective */
		.flip-container {
			float: left;
			padding-right: 1em;
			padding-bottom: 1em;
			display: inline-block;	
			perspective: 1000px;
		}
		.flip-container, .front, .back {
			border-radius: 50%;
			width: 4em;
			height: 4em;
		}
		/* flip speed goes here */
		.flipper {
			transition: 0.4s;
			transform-style: preserve-3d;
			position: relative;
		}
		/* hide back of pane during swap */
		.front, .back {
			text-align: center;
			backface-visibility: hidden;
			position: absolute;
			top: 0;
			left: 0;	
		}
		/* front pane, placed above back */
		.front {
			z-index: 2;
			/* for firefox 31 */
			transform: rotateY(0deg);
		}
		/* back, initially hidden pane */
		.back {
			line-height:4em;
			transform: rotateY(180deg);
			background-color: lightgrey;
		}
		.back span {
			font-size: 3em;
		}
		@media (min-width: 80em) {
			#backprofilepic {
				height: 8em;
				width: 8em;
			}
			#sidebar {
				position: absolute;
				left: 5em;
				/* distance from left side should = distance from left side of article to the left side of the window divided by two, and then subtract 5em */
				left: calc(calc(calc(50% - 25em) / 2) - 5em);
				top: 5em;
				text-align: center;
				line-height: 0px;
			}
			.flip-container {
				float: none;
				padding: 0px;
			}
			/* flip the pane when hovered */
			.flip-container:hover .flipper, .flip-container.hover .flipper {
				transform: rotateY(180deg);
			}
			.flip-container, .front, .back {
				width: 8em;
				height: 8em;
			}
			.back {
				line-height: 8em;
			}
			.back span {
				font-size: 6em;
			}
		}
		#contentbox {
			display: inline-block;
			padding-top: 3.5em;
			width: 100%;
			max-width: 50em;
			min-width: 10%
		}
		article {
			display: inline-block;
			text-align: left;
			padding-bottom: 3em;
			/* padding-left: 15vw; */
			/* width: 70vw; */
			width: 100%;
			max-width: 50em;
			min-width: 10%;
		}
		.kind {
			font-family: monospace;
			color: black;
			text-decoration: none;
		}
		.kind:hover {
			text-decoration: underline;
		}
		.entry-data {
			font-family: monospace;
		}
		@media (min-width: 80em) {
			article {
				margin-top: 2em;
				padding: 1em;
				border-radius: 25px;
				border: solid .2em lightgrey;
			}
		}
		article h1:first-of-type {
			line-height: 0px;
		}
		/* this was originally written for the graphs in the mapping afghanistan post */
		article img {
			width: 100%;
		}
		.centeredtext {
			text-align: center;
		}
		</style>
</head>
<body>
        <div id="sidebar">
                <a class="nostyle p-author h-card" rel="author" href="https://jacobhall.net/">
                <div class="flip-container" ontouchstart="this.classList.toggle('hover');">
                        <div class="flipper">
                                <div class="front">
                                        <img class="profilepic" id="backprofilepic" src="/images/toothbrush_profile_small.jpg" alt="sexy mirror selfie"/>
                                </div>
                                <div class="back">
                                        <span>üè†</span>
                                </div>
                        </div>
                </div>
                        <h5>‚¨ÖÔ∏è Jacob Hall's weblog</h5>
                </a>
        </div>
  <article>
<h2>Let's test some Skype URIs on MacOS!</h2>
<p>
It seems that Skype removed their Applescript functionality a few years back. I can't find an official announcement, but <a href="https://answers.microsoft.com/en-us/skype/forum/all/skype-8-not-scriptable/0a5e4fe4-87d9-4e45-86c0-ce00d224087f">this Microsoft Community thread</a> and almost no posts about the topic from the last ~5 years has me convinced.
</p>
<p>
So, what other options do we have to control Skype using scripts? Skype supports URIs, which basically are links that open applications instead of websites. There's <a href="https://docs.microsoft.com/en-us/skype-sdk/skypeuris/skypeuriapireference">a page on Skype's website</a> that describes the different actions your URI can make, including video calls! The syntax to make a video call is as follows:
</p>
<pre class="code">
skype:participant1[;participant2;...participant9]?call&amp;amp;video=true
</pre>
<p>
Since I'm just looking for a URI that makes a video call to one person, this should be pretty simple. But, what exactly do we replace "participant1" with to tell Skype who we want to call? Presumably the recipient's "Skype Name," which I found by clicking on my profile from within the Skype app:
</p>
<img style="height:30em; max-width:100%;" src="name-from-profile.png">
<p>
So, my Skype Name is <code>live:.cid.8e05c6f8360ed2c7</code>, glad to meet ya. Here's the HTML code for a link to video call me on Skype:
<pre class="code">
<span class="Purple">&lt;</span><span class="PurpleItalic">a</span><span class="Purple"> </span><span class="Blue">href</span><span class="Purple">=</span><span class="String">&quot;skype:live:.cid.8e05c6f8360ed2c7?call</span><span class="Special">&amp;amp;</span><span class="String">video=true&quot;</span><span class="Purple">&gt;</span>Call me on Skype<span class="Blue">&lt;/</span><span class="PurpleItalic">a</span><span class="Blue">&gt;</span>
</pre>
And here's what it looks like IRL: <a href="skype:live:.cid.8e05c6f8360ed2c7?call&amp;video=true">Call me on Skype</a><br>
When I clicked it, my phone started buzzing with an incoming Skype call. Hooray!</p>
<p>
Okay Jacob, that's great, but how do I use this fancy Skype URI from a script on my computer instead of opening this weird blog post to call you? On Mac, there's an <code>open</code> command that is capable of handling URIs. So if you open your Terminal application, and type the following in, and cross your fingers, it might just do the same thing:<br>
<i>Note that I added double slashes after the <code>skype:</code> because that's how it always looks in <code>open</code> code examples. It might also work without them</i>
<pre class="code">
open skype://live:.cid.8e05c6f8360ed2c7?call&amp;video=true
</pre>
<p>
This might work; I don't have a Mac of my own to fully test it out. If it does, you could use the Run Shell Script action in Automator to run this code within any Automator workflow.
</p>
</article>
</body>
</html>